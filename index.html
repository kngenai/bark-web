<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bark Translator — Web 🐶</title>
  <meta name="description" content="A playful dog bark translator tailored to breed, traits, and your Woof-Meter." />
  <!-- Helps avoid hotlink blocking referrers -->
  <meta name="referrer" content="no-referrer">
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- FUN BACKGROUND LAYER (cartoon dog + bubble) -->
  <div class="bg-hero">
    <img src="assets/dog bubble.png"
         onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Dog_cartoon.svg/512px-Dog_cartoon.svg.png';"
         alt="Cartoon dog" class="bg-dog" />
    <div id="bgBubble" class="bg-bubble">Woof means hello!</div>
  </div>

  <main class="wrap">
    <h1>Dog Bark Translator 🐶</h1>
    <p class="sub">Pick a breed, tap a few traits, dial in the Woof-Meter, then translate. <em>Entertainment only!</em></p>

    <!-- Hero (small mascot + bubble under title) -->
    <section class="hero">
      <div class="dog">
        <img id="heroDog" alt="Happy dog mascot"
             src="/assets/dog-hero.png"
             onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Husky_Walking.jpg/320px-Husky_Walking.jpg';" />
      </div>
      <div class="bubble-callout">
        <span id="heroBubble">Translator online. Begin borks.</span>
      </div>
    </section>

    <!-- Describe the Bark signposting -->
    <h2 class="section-title">Describe the Bark 🎤</h2>
    <p class="section-sub">Use the Woof-Meter to set how the bark sounds — count, pitch, urgency, mood, squirrel %, and zoomies.</p>

    <section class="controls" aria-label="Inputs">
      <!-- Breed -->
      <label for="breed">Dog breed</label>
      <select id="breed" class="select" aria-label="Dog breed">
        <option value="">— Select a breed —</option>
        <option>Labrador Retriever</option>
        <option>Golden Retriever</option>
        <option>German Shepherd</option>
        <option>French Bulldog</option>
        <option>Beagle</option>
        <option>Poodle</option>
        <option>Husky</option>
        <option>Border Collie</option>
        <option>Corgi</option>
        <option>Dachshund</option>
        <option>Shiba</option>
        <option>Australian Shepherd</option>
        <option>Boxer</option>
        <option>Rottweiler</option>
        <option>Great Dane</option>
      </select>

      <!-- Traits -->
      <label>Personality (tap a few)</label>
      <div class="chips" id="traitChips" role="group" aria-label="Personality traits">
        <button data-trait="goofy">goofy</button>
        <button data-trait="food-motivated">food-motivated</button>
        <button data-trait="squirrel-obsessed">squirrel-obsessed</button>
        <button data-trait="clingy">clingy</button>
        <button data-trait="zoomies">zoomies</button>
        <button data-trait="water-lover">water-lover</button>
        <button data-trait="guard dog vibes">guard dog vibes</button>
        <button data-trait="dramatic talker">dramatic talker</button>
        <button data-trait="nose-driven">nose-driven</button>
        <button data-trait="cuddle bug">cuddle bug</button>
      </div>

      <!-- Woof-Meter -->
      <div class="meter">
        <div class="meter-row">
          <div class="meter-label">Count</div>
          <div class="seg" id="countSeg">
            <button data-val="one_woof">One woof</button>
            <button data-val="two_woofs" class="on">Two woofs</button>
            <button data-val="pack_chorus">Pack chorus</button>
          </div>
        </div>
        <div class="meter-row">
          <div class="meter-label">Pitch</div>
          <div class="seg" id="pitchSeg">
            <button data-val="squeaky">Squeaky 🐭</button>
            <button data-val="middle" class="on">Middle 🎺</button>
            <button data-val="thunder">Thunder 💥</button>
          </div>
        </div>
        <div class="meter-row">
          <div class="meter-label">Urgency</div>
          <div class="seg" id="urgencySeg">
            <button data-val="casual_sniff">Casual sniff</button>
            <button data-val="snack_request" class="on">Snack request</button>
            <button data-val="snack_emergency">Snack emergency</button>
          </div>
        </div>
        <div class="meter-row">
          <div class="meter-label">Mood</div>
          <div class="seg" id="moodSeg">
            <button data-val="chill" class="on">Chill</button>
            <button data-val="alert">Alert</button>
            <button data-val="drama_queen">Drama queen</button>
          </div>
        </div>
        <div class="meter-row">
          <div class="meter-label">Squirrel %</div>
          <div class="seg" id="squirrelSeg">
            <button data-val="0">0%</button>
            <button data-val="50" class="on">50%</button>
            <button data-val="100">100%</button>
          </div>
        </div>
        <div class="meter-row">
          <div class="meter-label">Zoomies</div>
          <div class="zoom">
            <input id="zoomies" type="range" min="0" max="10" value="5" step="1" />
            <div id="zoomLabel" class="zoom-label">5 · Wigglebutt</div>
          </div>
        </div>

        <div class="meter-actions">
          <button id="randomizeWoof" class="btn ghost">🎲 Randomize woof</button>
        </div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button id="translateBtn" class="btn btn-primary">Translate</button>
      </div>
    </section>

    <!-- Result -->
    <section class="result" aria-live="polite">
      <div class="result-head">
        <b>Translation:</b>
        <button id="copyBtn" class="btn icon" aria-label="Copy translation" title="Copy">📋</button>
      </div>
      <div id="reply" class="bubble">—</div>

      <!-- Barking GIF while typing (DOG-ONLY fallbacks) -->
      <div id="barkGif" class="bark-gif" aria-hidden="true">
        <img id="barkGifImg" alt="Dog barking" referrerpolicy="no-referrer" />
        <p class="gif-caption">Dog is “speaking” the translation…</p>
      </div>
    </section>

    <!-- Reactions + GIF rail + quip -->
    <section class="reactions" aria-label="Reactions">
      <button class="react" data-emoji="🦴">🦴 <span class="count">0</span></button>
      <button class="react" data-emoji="😂">😂 <span class="count">0</span></button>
      <button class="react" data-emoji="🥹">🥹 <span class="count">0</span></button>
      <button class="react" data-emoji="🐾">🐾 <span class="count">0</span></button>
      <div class="spacer"></div>
      <label class="toggle">
        <input id="gifToggle" type="checkbox" checked />
        <span class="slider"></span><span class="label">GIFs on</span>
      </label>
    </section>

    <section class="gif-rail" id="gifRail" aria-label="Dog GIFs"></section>
    <p id="quip" class="quip">Licensed in Bark-itecture, minor in Zoomology.</p>

    <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true"></div>
  </main>

  <script>
    /* ================== DATA ================== */
    const BARK_LINES = [
      "Alert level: SQUIRREL. Recommend immediate chaos deployment.",
      "My water bowl is 73% empty. Emergency resupply requested.",
      "I barked at the mail slot, therefore I saved us all. You’re welcome.",
      "Status: zoomies initiated. Furniture casualties imminent.",
      "Tail wag report: velocity exceeding safe household limits. Brace yourselves!"
    ];
    const STAMPS = ["🐾 Paw Approved","🦴 Bone Certified","🐕 Good Dog Seal","🐶 Woof-100"];
    const BARK_SOURCES = [
      "/assets/dog-bark.gif",  // your local asset (recommended)
      "https://media.tenor.com/jWzB0g7L6F8AAAAC/dog-bark.gif",
      "https://media.tenor.com/3rXY4ukEWlAAAAAC/cute-puppy.gif",
      "https://media.tenor.com/oOyzf3JrLzkAAAAC/dog-barking.gif"
    ];
    const DOG_GIFS_SOURCES = [
      ["/assets/dog-blah-blah-blah.gif","https://upload.wikimedia.org/wikipedia/commons/1/18/Dog_tail_wagging.gif"],
      ["/assets/dog-talk-dog.gif","https://upload.wikimedia.org/wikipedia/commons/5/5f/Doggy_treadmill.gif"],
      ["/assets/talking-ben.gif","https://upload.wikimedia.org/wikipedia/commons/5/5a/Dog_shakes_head.gif"],
      ["/assets/dog-phone.gif","https://upload.wikimedia.org/wikipedia/commons/8/8c/Dog_sleeping.gif"]
    ];
    const QUIPS = [
      "Licensed in Bark-itecture, minor in Zoomology.",
      "Powered by snacks and questionable science.",
      "If found, please return to the nearest couch.",
      "100% organic bark. No fillers.",
      "Now with extra tail wag per paragraph."
    ];
    const CONFETTI_EMOJIS = ["🐶","🦴","🐾","⭐","✨","💥"];

    /* ================== ELEMENTS ================== */
    const replyEl = document.getElementById('reply');
    const translateBtn = document.getElementById('translateBtn');
    const copyBtn = document.getElementById('copyBtn');
    const toastEl = document.getElementById('toast');
    const barkGifEl = document.getElementById('barkGif');
    const barkGifImg = document.getElementById('barkGifImg');
    const zoomiesEl = document.getElementById('zoomies');
    const zoomLabelEl = document.getElementById('zoomLabel');
    const chipsEl = document.getElementById('traitChips');
    const gifRail = document.getElementById('gifRail');
    const gifToggle = document.getElementById('gifToggle');
    const quipEl = document.getElementById('quip');
    const bgBubble = document.getElementById('bgBubble');
    const heroBubble = document.getElementById('heroBubble');

    const segGroups = {
      count: document.getElementById('countSeg'),
      pitch: document.getElementById('pitchSeg'),
      urgency: document.getElementById('urgencySeg'),
      mood: document.getElementById('moodSeg'),
      squirrel: document.getElementById('squirrelSeg'),
    };

    let lastPlainLine = "";

    /* ================== HELPERS ================== */
    const pick = (arr)=>arr[Math.floor(Math.random()*arr.length)];
    const prefersReduced = ()=> window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches;

    function typeWriter(el,text,speed=40){
      if (prefersReduced()) { el.textContent = text; return Promise.resolve(); }
      el.textContent="";
      return new Promise(async (resolve)=>{
        for(let i=0;i<text.length;i++){
          el.textContent+=text[i];
          await new Promise(r=>setTimeout(r,speed));
        }
        resolve();
      });
    }
    function decorate(line){ return `${line} <div class="stamp">${pick(STAMPS)}</div>`; }
    function zoomLabel(v){
      const n=Number(v);
      const bucket=n<=2?"Couch potato":n<=6?"Wigglebutt":"Tornado";
      zoomLabelEl.textContent=`${n} · ${bucket}`;
    }
    function showToast(msg){
      toastEl.textContent=msg;
      toastEl.classList.add('on');
      setTimeout(()=>toastEl.classList.remove('on'),1500);
    }
    function popConfetti(count=24){
      if (prefersReduced()) return;
      const layer=document.createElement('div');
      layer.className='confetti'; document.body.appendChild(layer);
      const W=window.innerWidth;
      for(let i=0;i<count;i++){
        const s=document.createElement('span');
        s.className='piece';
        s.textContent=pick(CONFETTI_EMOJIS);
        s.style.left=(Math.random()*W)+'px';
        s.style.fontSize=(16+Math.random()*14)+'px';
        s.style.animationDelay=(Math.random()*300|0)+'ms';
        layer.appendChild(s);
      }
      setTimeout(()=>layer.remove(),1600);
    }
    function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }

    <script>
  // If you don't already have this helper, include it:
  function loadWithFallback(imgEl, sources, onFail){
    const list = [...sources];
    const tryNext = () => {
      if (!list.length) { onFail && onFail(); return; }
      const src = list.shift();
      imgEl.referrerPolicy = 'no-referrer';
      imgEl.src = src;
      imgEl.onerror = tryNext;
    };
    tryNext();
  }

  // 1) Background cartoon dog sources (local first, then permissive fallbacks)
  const BG_DOG_SOURCES = [
    "/assets/bg-dog-cartoon.png",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Dog_cartoon.svg/512px-Dog_cartoon.svg.png",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cartoon_Dog.svg/512px-Cartoon_Dog.svg.png"
  ];

  // 2) Small hero mascot sources
  const HERO_SOURCES = [
    "/assets/dog-hero.png",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Husky_Walking.jpg/320px-Husky_Walking.jpg",
    "https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Golden_Retriever_medium-to-light-coat.jpg/320px-Golden_Retriever_medium-to-light-coat.jpg"
  ];

  // Kick off loads (runs once on page load)
  const bgDog = document.getElementById('bgDog');
  const heroDog = document.getElementById('heroDog');

  loadWithFallback(bgDog, BG_DOG_SOURCES, () => {
    // If everything fails, hide the background layer gracefully
    const bg = document.querySelector('.bg-hero');
    if (bg) bg.style.display = 'none';
  });

  loadWithFallback(heroDog, HERO_SOURCES, () => {
    // If all fail, hide the little hero avatar
    const heroImg = document.getElementById('heroDog');
    if (heroImg) heroImg.style.display = 'none';
  });
</script>


    /* ================== UI WIRING ================== */
    // Chips
    chipsEl.addEventListener('click', (e)=>{
      if (e.target.tagName!=='BUTTON') return;
      e.target.classList.toggle('chip-on');
    });

    // Segmented groups (single select)
    Object.values(segGroups).forEach(seg=>{
      seg.addEventListener('click', e=>{
        if (e.target.tagName!=='BUTTON') return;
        seg.querySelectorAll('button').forEach(b=>b.classList.remove('on'));
        e.target.classList.add('on');
      });
    });

    // Randomize woof
    document.getElementById('randomizeWoof').onclick=()=>{
      Object.values(segGroups).forEach(seg=>{
        const btns=Array.from(seg.querySelectorAll('button'));
        const r=pick(btns);
        btns.forEach(b=>b.classList.remove('on'));
        r.classList.add('on');
      });
      const z=Math.floor(Math.random()*11);
      zoomiesEl.value=z; zoomLabel(z);
    };

    // Zoom label
    zoomiesEl.addEventListener('input',e=>zoomLabel(e.target.value));
    zoomLabel(zoomiesEl.value);

    // Copy
    copyBtn.onclick=async()=>{
      if(!lastPlainLine){ showToast("Nothing to copy"); return; }
      try{ await navigator.clipboard.writeText(lastPlainLine); showToast("Copied!"); }
      catch{ showToast("Copy failed"); }
    };

    // GIF rail (hotlink-safe fallbacks)
    function renderGifs(){
      if(!gifToggle.checked){ gifRail.innerHTML=""; return; }
      const picks=shuffle(DOG_GIFS_SOURCES).slice(0,4);
      const CAPS=[
        "Explaining advanced Barkonomics.",
        "Consulting Professor Ben.",
        "Zoomies research in progress.",
        "Bark stream, 24/7."
      ];
      gifRail.innerHTML=picks.map((arr,i)=>`
        <figure class="gif-card">
          <img referrerpolicy="no-referrer" alt="Dog gif" />
          <figcaption class="caption">${CAPS[i%CAPS.length]}</figcaption>
        </figure>
      `).join("");
      Array.from(gifRail.querySelectorAll('.gif-card')).forEach((card,i)=>{
        const img=card.querySelector('img');
        // try local then Wikimedia fallback
        loadWithFallback(img, picks[i], ()=>{
          card.classList.add('failed');
          img.remove();
        });
      });
    }
    gifToggle?.addEventListener('change', renderGifs);

    // Small hero bubble rotation
    setInterval(()=>{
      heroBubble.textContent = pick([
        "Translator online. Begin borks.",
        "Fluent in Treatish.",
        "Certified Good Dog™ interpreter.",
        "Now decoding tail-wags…",
        "Woof to text engaged."
      ]);
    }, 3500);

    /* ================== BACKGROUND BUBBLE ROTATION + SYNC ================== */
    const BUBBLE_LINES = [
      "Woof means hello!",
      "Arf arf = snacks now.",
      "Bork bork → intruder alert!",
      "Zoomies are my cardio.",
      "Translation: I run this house.",
      "Tail wag = 100% approval.",
      "Sniff sniff... data collected."
    ];
    let bubbleIndex=0, bubbleTimer=null, resumeTimer=null;

    function fadeSwap(el, text, dur=300){
      el.style.transition='opacity '+dur+'ms ease';
      el.style.opacity='0';
      setTimeout(()=>{ el.textContent=text; el.style.opacity='1'; }, dur);
    }
    function startBubbleRotation(){
      stopBubbleRotation();
      bubbleTimer=setInterval(()=>{
        bubbleIndex=(bubbleIndex+1)%BUBBLE_LINES.length;
        fadeSwap(bgBubble, BUBBLE_LINES[bubbleIndex]);
      }, 4000);
    }
    function stopBubbleRotation(){ if(bubbleTimer){ clearInterval(bubbleTimer); bubbleTimer=null; } }
    function setBgBubble(text, holdMs=8000){
      stopBubbleRotation();
      fadeSwap(bgBubble, text);
      if(resumeTimer) clearTimeout(resumeTimer);
      resumeTimer=setTimeout(()=>startBubbleRotation(), holdMs);
    }
    startBubbleRotation();

    /* ================== TRANSLATE (NO API) ================== */
    function readSegVal(segId, fallback){ return document.querySelector(`#${segId} .on`)?.dataset.val ?? fallback; }
    function squirrelEasterEgg(){ return "SQUIRREL ALERT. All systems redirect to window patrol. If lost, follow the chaos trail."; }
    function tornadoEasterEgg(){ return "Zoomies at DEFCON 1. Sofa, it’s not you—it’s me. BRB in a blur."; }

    async function doTranslate(){
      // choose line (you can factor in meters if you want)
      const squirrel = Number(readSegVal('squirrelSeg','50'));
      const zoomies = Number(zoomiesEl.value || 5);
      let line;
      if (squirrel === 100) line = squirrelEasterEgg();
      else if (zoomies >= 10) line = tornadoEasterEgg();
      else line = pick(BARK_LINES);

      lastPlainLine = line;

      // barking gif on
      loadWithFallback(barkGifImg, BARK_SOURCES, ()=> barkGifEl.style.display='none');
      barkGifEl.classList.add('on');

      // type, then decorate
      replyEl.classList.remove('new'); void replyEl.offsetWidth; replyEl.classList.add('new');
      await typeWriter(replyEl, line, 40);
      replyEl.innerHTML = decorate(replyEl.textContent);

      // barking gif off
      barkGifEl.classList.remove('on');

      // mirror to background bubble for ~8s, then resume rotating
      setBgBubble(lastPlainLine);

      // flair
      if (Math.random() < 0.35) popConfetti(28);
      renderGifs();
      quipEl.textContent = pick(QUIPS);
    }

    translateBtn.onclick = doTranslate;

    // Initial fun render
    renderGifs();
    quipEl.textContent = pick(QUIPS);
  </script>
</body>
</html>


